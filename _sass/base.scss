// Lora font face
@font-face {
  font-display: swap;
  font-family: Lora;
  src: url(../fonts/Lora-VariableFont_wght.ttf);
}
@font-face {
  font-display: swap;
  font-family: Lora;
  font-style: italic;
  src: url(../fonts/Lora-Italic-VariableFont_wght.ttf);
}
// Open Sans font face
@font-face {
  font-display: swap;
  font-family: 'Open Sans';
  src: url(../fonts/OpenSans-VariableFont_wdth,wght.ttf);
}
@font-face {
  font-display: swap;
  font-family: 'Open Sans';
  font-style: italic;
  src: url(../fonts/OpenSans-Italic-VariableFont_wdth,wght.ttf);
}

// sets font size to 10px default, useful with rem values
:root { font-size: 62.5%; }

::selection {
  background: $color-highlight-bg;
  color: $color-highlight;
}

html { background: $color-bg; }

body {
  color: $color-primary;
  font-family: 'Open Sans', sans-serif;
  font-size: 1.8rem;
  line-height: 1.6;
  margin: 0;
}

:is(h1, h2, h3, p.cap, .gallery, .feature div div, .pagenav, sup, .toc, .plainlinks) :is(a, a:active, a:visited), a:has(img) { text-decoration: none; }
:is(h1, h2, h3, p.cap, .gallery, .feature div div, .pagenav, sup, .toc) :is(a, a:active, a:visited), a:has(img) {
  &[target="_blank"]::after { content: none; }
  &[href]:where([href^="http"])::after { content: none; }
}
h1, h2, h3 {
  font-family: Lora, serif;
  letter-spacing: .02rem;
  margin: 1.5rem 0 1rem;
  + p { margin-top: 1rem; }
}
h1 {
  font-size: 3.2rem;
  ~ .pagenav { margin-bottom: 1.5rem; }
}
h2 { font-size: 2.4rem; }
h3 { font-size: 1.9rem; }

p {
  margin: 1.5rem 0;
  // heading captions
  &.cap {
    color: $color-secondary;
    font-size: 1.5rem;
    margin-bottom: .8rem;
    margin-top: -1rem;
    + p { margin: .8rem 0 1rem; }
  }
}

sup { line-height: 0; }

a, a:active, a:visited {
  color: $color-link;
  text-decoration: $color-primary underline 8%;
  text-underline-offset: 8%;
  // internal _blank
  &[target="_blank"]::after { content: ' ❐'; }
  // external link
  &[href]:where([href^="http"])::after { content: ' ⧉'; }
}
a:hover {
  color: $color-primary;
  img { opacity: .75; }
}

ul, ol {
  padding-inline-start: 6%;
  &.spaced li, &.spaced li ul li, &.spaced li ol li { margin: 1rem 0; }
}
ol ol { list-style-type: lower-alpha; }

code { white-space: nowrap; }

.table {
  margin: 1.5rem auto;
  overflow-x: auto;
  table {
    border-collapse: collapse;
    margin: 0 auto;
    text-align: left;
    th, td { vertical-align: top; }
    th[colspan="2"], td:has(img:not(.flag)) { text-align: center; }
    th small { font-weight: normal; }
    &.full { width: 100%; }
    &.inline { margin: 0; }
    &.borders {
      th { background-color: $color-shade; }
      th, td {
        border: .1rem solid $color-border;
        padding: 1rem;
      }
    }
    &.small, &.small .caption {
      font-size: 1.5rem;
      th, td { padding: .8rem; }
      .flag { height: 1.1rem; }
    }
    &.smaller, &.smaller .caption {
      font-size: 1.3rem;
      th, td { padding: .7rem; }
      .flag { height: 1rem; }
    }
    &.smallest, &.smallest .caption {
      font-size: 1.2rem;
      th, td { padding: .6rem; }
      .flag { height: .9rem; }
    }
  }
}

// floats
.left, .right, .thumb img { width: 231px; }
.left, .right {
  clear: both;
  table img {
    max-width: 231px;
    width: 100%;
  }
  &:is(.table) {
    &:is(.caption + .table) { margin-top: 0; }
    &:is(.cap + .table) { margin-top: .8rem; }
  }
  // do not add top margin on image captions in tables
  .caption:not(table .caption) { margin-top: .5rem; }
}
.left {
  float: left;
  margin-right: 1.5rem;
}
.right {
  float: right;
  margin-left: 1.5rem;
}

.toc {
  border-bottom: .1rem solid $color-border;
  border-top: .1rem solid $color-border;
  cursor: default;
  font-size: 1.5rem;
  list-style-type: none;
  margin-bottom: 2rem;
  padding: 2%;
  &::before {
    content: 'Contents:';
    display: block;
    font-weight: bold;
  }
  li {
    + li::before { content: " · "; }
    &:is(:first-of-type:not(ul li ul li), li + :has(ul), :has(ul) + li) {
      padding-inline-start: 1rem;
      &::before { content: "↳ "; }
    }
    &:not(:has(ul)) { display: inline; }
  }
  ul {
    display: inline;
    padding: 0;
    li {
      &:first-child::before { content: '('; }
      &:last-child::after { content: ')'; }
    }
  }
}

.footnotes {
  clear: both;
  color: $color-secondary;
  font-size: 1.3rem;
  &::before { content: "Footnotes:"; }
  .reversefootnote { text-decoration: none; }
}

// Page navigation
.pagenav {
  clear: both;
  margin-top: 1.5rem;
  overflow: hidden;
  &:last-child { margin-top: 2rem; }
  p { margin: 0; }
  ~ h1 { margin-top: 1rem; }
  .return, .advance { cursor: default; }
  .return {
    float: left;
    font-size: 1.5rem;
  }
  .advance {
    float: right;
    font-size: 1.5rem;
  }
}

// image captions
.caption, .caption p {
  color: $color-secondary;
  font-size: 1.3rem;
  text-align: center !important;
}
.caption p { margin-bottom: 2.5rem; }

// column lists
.cols2, .cols3, .cols4 { column-gap: 3rem; }
// two-column lists
.cols2 {
  column-count: 2;
  font-size: 1.5rem;
  .flag { height: 1.1rem; }
}
// three-column lists
.cols3 {
  column-count: 3;
  font-size: 1.3rem;
  .flag { height: 1rem; }
}
// four-column lists
.cols4 {
  column-count: 4;
  font-size: 1.2rem;
  .flag { height: .9rem; }
}

.flexmenu {
  column-gap: 1rem;
  display: flex;
  flex-wrap: wrap;
  row-gap: 1rem;
  .feature.option {
    margin: 0;
    width: 16rem;
  }
}

.story p {
  hyphens: auto;
  text-align: justify;
  + p { text-indent: 4rem; }
}

.gallery {
  display: flex;
  flex-wrap: wrap;
  margin: 0 auto;
  text-align: center;
  div {
    margin: .5rem;
    max-width: 150px;
    width: min-content;
  }
  img {
    max-height: 150px;
    max-width: 150px;
  }
  p {
    margin: .1rem 0;
    a { white-space: normal; }
  }
}

.feature {
  align-items: center;
  display: flex;
  margin: 2rem 0;
  h2 {
    margin-top: .5rem;
    + p:not(.cap) { margin-top: -.5rem; }
  }
  img {
    display: block;
    margin-right: 2.5rem;
    width: 125px;
  }
  > div { width: 100%; }
  div div {
    color: $color-secondary;
    display: flex;
    justify-content: right;
    margin-top: 2rem;
  }
  &.option {
    margin: 1rem 0;
    text-decoration: none;
    width: fit-content;
    &[target="_blank"]::after { content: none; }
    &[href]:where([href^="http"])::after { content: none; }
    p { margin: 0; }
    img, &.cropped img {
      height: 50px;
      margin-right: 1.5rem;
      width: 50px;
    }
  }
  &.cropped {
    img {
      height: 125px;
      object-fit: cover;
      width: 125px;
    }
  }
  &.standout {
    align-items: center;
    background: $color-shade;
    border: .1rem solid $color-border;
    padding: 2rem 3rem;
  }
}